# 激光点云三维建模、地形图测量方法

+ 目录：
    1. [基于激光扫描数据的三维可视化建模_路兴昌](src/基于激光扫描数据的三维可视化建模_路兴昌.pdf)
    2. [基于强度与颜色信息的地面LiDAR点云联合分类方法](src/基于强度与颜色信息的地面LiDAR点云联合分类方法.pdf)
    3. [基于三维激光扫描技术的校园可视化_赵小平](src/基于三维激光扫描技术的校园可视化_赵小平.pdf)
    4. [建筑物三维激光点云数据配准及建模研究_杜希建](src/建筑物三维激光点云数据配准及建模研究_杜希建.pdf)
    5. [三维激光扫描的点云数据处理与建模研究_曾如铁](src/三维激光扫描的点云数据处理与建模研究_曾如铁.pdf)
    6. [三维激光扫描技术在精细地形图绘制中的应用_胡奎](src/三维激光扫描技术在精细地形图绘制中的应用_胡奎.pdf)
    7. [标靶的介绍](src/标靶.md)

+ 概括：
    1. 基于激光扫描数据的三维可视化建模_路兴昌
       1. 技术路线
          1. 原始激光扫描测量数据
          2. 提取地物数据
          3. 建筑物去噪
          4. 纠正得到建筑物二维平面数据
          5. 重采样得到建筑物三维数据
          6. 最后做坐标变换，统一坐标系
          7. 文字介绍（首先根据已知信息对获取的原始扫描观测值进行地物提取，将地形数据与地物数据分离；其次对建筑物数据进行噪声去除处理，去除测量噪声、遮挡物（如树木等）的影响，得到建筑物整体信息；再次，通过基于平面特征的图像分割对建筑物进行识别，并根据建筑物自身特征，对连续扫描的激光测量断面进行整体匹配纠正，得到建筑物特征点和二维平面特征；之后，再根据总体纠正信息对原始测量数据进行重新采样和计算，得到反映建筑物表面几何特征的三维扫描坐标；最后对三维坐标进行建模与三维可视化处理。）
       2. 地物提取
          1. 然后激光会按照先从上到下(逐行)，再从右到左(逐列)的方向来扫描投射在此矩形区域中的实际场景点。
          2. 激光扫描获取的数据往往包含地形数据、建筑物数据和其它地物数据。
          3. 地物提取的目的就是为了将目标建筑物从激光测量数据中分离出来，为后续处理提供基础数据。
          4. 地形数据与地物数据分离法则为：高度值小于仪器高度的点视为地形点数据；高度值大于仪器高度的点作为地物数据。
          5. 建筑物数据与树木等地物数据的分离比较困难，我们将目标建筑物之外的地物作为噪声进行去噪处理。
       3. 去噪滤波
          1. 树木、行人、车辆等位于三维激光扫描仪与主要被测物之间的遮挡物，通过激光扫描后会在主要被测物之后形成散乱点或者空洞等噪声。
          2. 对目标建筑物数据去噪滤波就是为了去除测量噪声、遮挡物(如树木等)的影响，得到建筑物数据。
          3. 根据激光扫描回波信号强度辨别，回波信号强度低于阈值时，距离信号值无效；利用中值滤波，剔除奇异点；利用曲面拟合去除前端遮挡物。通过上述方法处理，可以剔除原始点云数据中的错误点和含有粗差的点。
       4. 几何纠正
          1. 应用基于平面特征的算法进行图像分割（协方差）
          2. 进行图像平面分割，淘汰了那些拟合不好的点并同时求出了拟合成功的点的法向量
          3. 通过阈值的调整，可以保证每个点集中的点数足够得多，从而较好地拟合实际的平面，得到很好的分割结果
       5. 面向对象技术进行三维建模
          1. 几何模型和纹理模型两大类，适用于图形表示的几何模型又分为点模型、线模型、面模型和体模型四类。
       6. 重采样
          1. 根据建筑物的总体纠正信息对原始测量数据进行重采样，就可得到反映建筑物表面几何特征的三维扫描坐标，主要是正确获得建筑物的立面几何信息
          2. 将每一扫描线看成分段光滑曲线，从上至下(或从左至右)，进行局部二次拟合，得到逼近的距离图像
          3. 检测深度和拟合点的法向连续性，并生成边缘映射图，提取三维轮廓边缘
          4. 由二维网格链码跟踪获取不同的边缘链，沿边缘链搜索并确定边缘拐点，去除小于某一长度的边缘链
          5. 根据用户指定将距离图像等分为N幅子距离图像，各子图像间有且仅有一重叠边，分别在子距离图像内进行自适应采样。
       7. 拼接匹配
          1. 将这些从不同位置获取的深度图像配准(Register)到一个坐标系下。
          2. 因此，多幅扫描结果之间的拼接匹配，实际上就是要找出两个坐标系之间的变换关系，解决坐标变换的问题。
          3. 这种关系一般用一个 3×3 的旋转矩阵 R 和 3 维平移向量 t 来描述，配准就是要求解出(R , t)。
          4. 为了求出R 和t，需要在两幅深度图像中找出若干组对应的特征，根据这些对应特征来求解R 和t。
          5. 在RiSCAN PRO 软件中，我们以前述选取的11 个特定反射参照目标当作地面控制点，利用它们的高对比度特性实现扫描影像的定位以及扫描数据和影像数据之间的匹配，不同位置点获取的多幅点云数据最后被拼接匹配在统一的工程坐标系(Project Coordinate System, PRCS)下。
       8. 表面重建
          1. 通过全排序操作并考虑所有可能的“约束条件”(例如折线)，将表面邻近部分的邻接关系和特殊特征(例如边)加以保留，以确定建筑物表面总的拓扑结构。
          2. 对每一个基本单位，根据这4 个点的位置关系，可以生成上述7 种情况中的一种网格形式，产生的三角化网格要满足一定的质量要求，例如限制网格元素的大小、折线不相交等。
          3. 由于室外场景存在遮挡和自遮挡，以及材料表面对激光的不同反射特性，以致主要被测物表面某些区域无法采样而产生许多空洞，故要求网格在生成过程中自动识别空洞。
          4. 生成四边形网格并进行三角剖分，是解决这一问题的有效办法。四边形网格可按水平和垂直采样顺序将采样点简单连接，并将空洞部位记为背景点。
       9. 三维可视化
          1. 坐标变换：在激光扫描的同时，采用传统手段(如全站仪测量)，获得每幅扫描中控制点的坐标和方位，再进行坐标转换、计算
          2. 纹理映射：用图像来替代物体模型中的可模拟或不可模拟细节，提高模拟逼真度和显示速度
    2. 基于强度与颜色信息的地面LiDAR点云联合分类方法
    3. 基于三维激光扫描技术的校园可视化_赵小平
    4. 建筑物三维激光点云数据配准及建模研究_杜希建
    5. 三维激光扫描的点云数据处理与建模研究_曾如铁
       1. 技术路线图
          1. 点云数据采集
          2. 点云滤波
             1. 半径滤波统计滤波
             2. 双边滤波算法及其优化算法
          3. 点云配准
             1. 标靶配准与icp配准的结合
             2. 基于sac-ia初始配准的icp配准
             3. 基于sac-ia初始配准的ndt配准
          4. 点云三维重建
             1. 线框绘制轮廓线法
             2. nubrs曲面建模法
       2. 三维激光扫描的特点
          1. 获取信息速率快
          2. 具有主动性和实时性
          3. 免接触目标
          4. 高精度、高分辨率
          5. 数字化采集、便于传输
          6. 平台分类
             1. 按照不同的搭载平台分类
                1. 机载激光扫描系统
                2. 地面激光扫描系统
             2. 按照扫描系统测距原理分类
                1. 脉冲法测距原理
                2. 相位法测距原理
                3. 三角法原理
       3. 三维模型重建
          1. 外业数据采集
          2. 建立拓扑关系
          3. 点云数据去噪
             1. 半径滤波与统计滤波
             2. 双边滤波与优化算法
          4. 点云数据配准
             1. 建筑物配准
                1. 标靶配准结合icp配准
             2. 雕塑与bunny配准
                1. sac-icp
                2. sac-ndt配准
          5. 三维模型重建
             1. 轮廓特征提取建模法
             2. nubrs曲面建模法
          6. 模型贴图
       4. 建筑物数据采集
          1. 测区勘探
          2. 控制网布设
          3. 标靶布设
             1. 在布置标靶时，应注意两不同测站间至少应布置三个平面标靶，且三个平面标靶不能位于一条直线上，另外标靶之间应错落有致，在保持一定高差的基础上交错布置
             2. 全站扫描仪
             3. 扫描采用 250 点/秒
             4. 水平和竖直采样点距离均为 2mm
          4. 扫描工作的具体实施
             1. 本次扫描采用的是独立坐标系。在定向后即可开始扫描。
             2. 另外还需设置平均扫描距离，最小和最大扫描距离，这些距离需要通过各个测站到扫描建筑物的实际距离来分别确定。
             3. 每站扫描之前可先利用仪器的测距功能测量该站扫描的最大距离与最小距离。
          5. 扫描数据的存储与导出
       5. 雕塑数据采集
          1. 控制网布设
          2. 扫描工作具体实施
          3. 扫描的水平间隔和垂直间隔都设置为 1mm，以保证达到曲面重构精度的要求
       6. 拓扑关系建立
          1. 包围盒法：采用包围盒法需注意小立方体边长的选取，若边长选择不合适会造成邻近点搜寻错误。
          2. 八叉树：在点云数据分布较为规则时有较好的效果。
          3. K-D 树：是将数据所在的 K 维空间进行划分以便于更快的查询用户所需要的信息的数据结构
       7. 建筑点云数据去噪
          1. 建筑用cloudcompare将点云分为树木和建筑两类，利用segment功能粗略的去除噪声
          2. 随后利用Statistical Outlier Removal、Noise Filter、Gaussian Filter等功能进行精细的去噪与滤波工作
       8. 雕塑点云去噪
          1. 对于游离在整体点云数据之外的部分点，本文在进行雕塑点云去噪实验时将其归为大尺度噪声，通过设置半径和距离阈值的方式来去除。
          2. 统计滤波：
             1. 选择原因：游离于整体点云数据的大尺度噪声，若采用中值滤波等常用方法进行去除可能会使得点云的有效数据点过度平滑，而采用统计滤波和半径滤波组合的方式将这类噪声去除更为合理
             2. 原理：是将点云数据视为高斯分布，对点云中的每个点，计算它到其邻域中所有近邻点的距离并取平均距离。
             3. 使用pcl vscpp：PCL 中统计滤波以选择的邻域点个数 K 与标准差阈值λ为参数进行大尺度噪声的去除（多次实验参数）
          3. 半径滤波
             1. 定义：是指在三维点云数据中，用户根据整体点云的分布情况设定一个近邻点数 N，所有的数据点在其半径为 r 的邻域内近邻点数需要满足大于等于 N，如果近邻点数小于 N,那么该点就被视为不符合滤波要求应作为噪声去除。
          4. 双边滤波及其优化算法
             1. 综合考虑空间信息相似度和像素相似度，滤波因子则包括点距离与灰度差两方面的内容，从而通过加权平均的方法来实现保边去噪。
             2. 双边滤波由于在权因子中加入了高斯方差因子，其在局部细节特征尤其是边缘信息的保存方面有一定的效果。但是当面对夹杂较多噪声的点云数据时，此时过多的噪声点会干扰对局部法向量等特征的估计从而影响算法中的权因子的计算，这样会丢失局部细节特征并造成较多的噪声残留
          5. 雕塑滤波实验结果比较
             1. 优化权因子的双边滤波算法则在取得理想的光顺效果的同时好的保留了细节特征，因此本次实验采用改进算法对雕塑点云进行小尺度噪声的去除
       9. 点云数据配准
          1. 使用pcl
          2. 各站数据都采用相同的分辨率，因此基本不存在数据缩放的问题，也即各站数据之间的变换仅有刚体变换，七参数中的λ=1，仪器坐标系需要在绕自身的三个坐标轴旋转后将此坐标系的原点通过平移转移到参考系的坐标原点处
          3. 刚性变换
             1. 通过至少三组同名特征点求得这六个变换参数之后，就能利用上式求得当前测站的点云在另一测站坐标系下的坐标
          4. 四元数法
             1. 旋转矩阵通常是用各方向的欧拉角来表示，而欧拉角有时会出现在各方向进行插值较困难且无法明确旋转次序的问题，在这种情况下寻找合适的方法代替欧拉角来描述旋转矩阵就相当有必要
          5. 配准目标函数的确定及分析
             1. 分别计算获取的两点集X 与Y 点集的数据集中心位置
             2. 根据点集中其他位置坐标与中心位置的差值计算协方差矩阵
             3. 由协方差矩阵的迹及该矩阵与其转置的关系可构造如下矩阵
             4. 计算上述矩阵的特征值
             5. 平移向量
             6. 根据上步结果可求得坐标变换向量
             7. 将以上求解的变换参数作用于X 获得变换后的位置X1 ,若方差变化小于阈值则可视为迭代完成，否则以变换后的位置X1 为初始点继续迭代
          6. 建筑物标靶配准
             1. 目前关于点云配准在经过众多学者较长时间的研究后出现了许多有效的方法，大致可将其分为有特征的配准方法和无特征的配准方法。所谓有特征的配准方法即利用标靶或者不同视角扫描对象的公共区域中较为明显的特征点、特征线、面等来完成配准工作。
             2. 平面或球形标靶，在两站扫描的重叠区域放置标靶，运用后处理软件对标靶进行坐标的提取，最后通过同名标靶的坐标解算配准参数从而完成配准，本次实验由于仪器未配备特制标靶采用自制平面标靶进行实验。
             3. 配准转换参数的求解
                1. 本次实验采用附有参数的间接平差方法来求取标靶配准中的转换参数。
                2. 配准转换参数的求解
             4. 有序列配准和同步配准两种方法。
                1. 同步配准是将多个测站的数据同时整合到一个坐标系下，虽然可以有效的将误差分配到各站但其计算复杂度高。
                2. 而序列配准则是依次对相邻的测站数据进行两两配准，该方法避免了将点云数据一次性导入从而减少了计算量。
                3. 本次对建筑物的整体配准采用序列配准的方法
          7. 初始位姿估计
             1. 以标靶配准为代表的有特征配准方法人工参与度较高，对于表面复杂且不具有明显特征的目标进行精细配准有特征配准法是无法满足要求的。
             2. 目前在配准领域占主导地位的是拥有较高精度的 ICP 算法，若不满足初始条件则易在局部区域形成收敛从而整体配准失败，因此在待配准点云中寻找某些特征来获取初始位姿是 ICP 算法能够成功实现的充分条件。
             3. 关键点的获取
                1. NARF 关键点的提取是对局部表面变化区域进行边缘检测，同时确定变化系数及主方向，最终在主方向上进行一系列的计算完成提取。
             4. 法线与曲率的估计
                1. 法线和曲率估计是围绕点云中某点与其附近 K 邻域的关系来近似计算每个点处的表面法线和曲率，法线与曲率信息主要是为计算局部特征做好准备并用于点云配准阶段。
             5. PFH 算子与 FPFH 算子
                1. 但实际场景的点云数据通常情况下拥有大量特征点，将它们应用于特征表示会造成点云信息特征的丢失，并且容易推断用这些一维特征来完成配准会形成较多的错误匹配，因此寻找合适的特征描述子来更好的描述特征是很有必要的。
                2. SAC-IA 配准：
                   1. 采样一致性初始配准算法
                   2. 它在穷举的 FPFH 所对应的特征空间中执行快速搜索，在多次迭代找到最佳变换后使用非线性优化方法来寻找良好的对应关系
                      1. 从原始点云 P 中筛选数量为 n 的样本点，样本点需满足两两匹配的距离大于设置的阈值
                      2. 根据 FPFH 计算结果在 Q 中寻找与 P 中样本点的直方图一致或相似的目标点，随后在目标点中随机挑选一个点来代表采样点的对应关系
                      3. 依据上步得到的对应关系来解算变换参数，采用 Huber 公式来度量误差并评价质量
          8. ICP 配准法及其改进措施
             1. ICP 算法原理
                1. 是在待配准的两组点云中寻找到最近点对后，然后通过精密的计算来求得新的相对应的最近点对，这里的计算是通过迭代运算来实现的，迭代运算到以欧式距离为测度的距离平方和能够满足先前设定的阈值需求即可完成迭代，实现配准。
                2. 解决了各种曲面配准的问题
                3. ICP 算法在不断的迭代计算过程中获得新的最近点对，利用每次的最近点对求得刚体变换参数继而组成变换矩阵，当满足某种收敛原则时即可停止迭代，最后借助最优变换矩阵将源点集映射到目标点集。
                4. ICP 算法的局限性
                   1. ICP 算法要求待配准的两片点云满足重合或包含的关系。
                   2. 由于 ICP 算法的配准是直接在参与配准的原始数据之上进行的，对于两片点云的位置关系无法进行有效的判断，因此其配准的精细程度很大程度上取决于一个良好的初始位姿，这对点云初始位置关系提出了较高的要求。
                   3. ICP 算法是一个不断迭代的过程，由于每一次迭代都要在计算新的变换参数同时在其中一片点云的所有点中遍历搜寻在另一点云中一一对应的最近点，这使得算法的复杂度大大增加。
                5. 改进
                   1. 众多优秀文献已经给出了各种粗配准算法，如中心叠加法、运用加权法重新定义点云中两点的距离等。
                   2. **本文首先提取点云中的 NARF 特征点并计算表面法线，然后提取点云的 FPFH 特征，最后利用 SAC-IA 实现粗配准。**
                   3. 密集的点云数据会增加算法的时间复杂度，对处理数据的计算机也是不小的挑战，因此需要对点云数据进行采样。
                   4. **拟采用体素下采样的方法来对点云数据进行精简，该方法能较为显著的实现简化点云的工作并且保证局部信息的存留。**
                   5. 由于 ICP 算法要求参与精细配准的点云的包含关系有一定要求，这对于大多数实际配准过程是很难满足的。
                   6. **本文运用 RANSAC 算法通过点之间的距离确定内部点并去除离群点，能够有效的去除错误点对为更精确的 ICP 算法提供一个较好的初始位姿。**
                   7. ransac介绍略
          9. NDT 配准算法
             1. 从两组实验的效果图及表格的对比来看，若采用 SAC-NDT 的方法进行配准，经过 SAC-IA 算法对初始位置进行了调整，算法的运行效率和对齐效果都有一定的改善。
             2. 而 SAC-ICP 在算法效率上比 SAC-NDT 算法稍逊，但精度有不小的提升
       10. 建筑物三维模型重建
           1. 本次实验采用徕卡 MS60 三维激光扫描仪对校园明德楼部分建筑进行了多方位的扫描，将扫描的点云数据导入 CAD 中并利用其UCS 功能对不同立面的**线框轮廓**特征图进行绘制，最后将线框图转入 3dmax 中完成模型重建和纹理贴图的工作。
           2. 首先将整体线框图导入 3dmax 中，需要注意 CAD 与 3dmax 的单位都需设置成毫米，否则在 3dmax 中会出现图形太小而无法显示的情况。
           3. 上述生成的各视角的模型已经基本表现了建筑的外部轮廓和门窗等细部特征，最后我们还需要将各单面的模型在透视图中拼接为一个整体并进行模型贴图以更真实的还原建筑物的原始形态。建筑物的形状较为规则，因此无需进行 UV 等操作，利用之前用扫描仪采集的纹理信息和 Photoshop 的优化处理得到的贴图效果。
           4. 从表中可知，明德楼建筑主体模型相对较大，绝对误差为 0.016m，而门、窗、柱子的绝对误差均在 1cm 以内，由各部位的误差计算出明德楼建筑模型平均误差为0.007m, 整体精度较高.
       11. 雕像三维模型重建
           1. 点云的精简，但待配准的两片点云所共有的重叠部分在配准后可能会造成数据的冗余
           2. 点云的去噪与封装
           3. 多边形处理阶段
              1. 多边形填孔
                 1. 目标对象表面由于风吹日晒造成材料脱落，这样材质的不同会造成对激光反射能力的不同从而形成孔洞；
                 2. 扫描区域周围有其他地物及随机噪声的遮挡，或者仪器即使变换视角也无法采集到的盲区。
                 3. 在先前的点云配准和去噪等预处理流程中未能达到应有的效果，从而使点到多边形的三角化过程出现偏差。
              2. 平滑处理
              3. 曲面重建阶段
                 1. NUBRS（非均匀有理 B 样条）建模通常由曲线和曲面拟合而成，其中非均匀性表示通过移动曲面中某个顶点其周围区域的分布情况会受影响。
           4. 模型偏差分析
    6. 三维激光扫描技术在精细地形图绘制中的应用_胡奎
       1. 数据采集
          1. Leica公司的HDS  ScanStation  C10三维激光扫描仪进行测区点云数据采集，考虑到仪器最大扫描距离为300  m，且扫描精度随着距离加大而逐步降低。
       2. 点云数据配准与坐标转换
          1. 因此，扫描中采用“分块”的扫描策略，即东、西两侧并排向前推进扫描，西侧布设了15、东侧布设了9站.
          2. 在测区范围内布设控制点 13 个，扫描时在此点架设靶标，并利用 GPS-RTK 技术测定其大地坐标值.
          3. 在每一测站上所获得的点云数据都是基于仪器内部自定义的坐标系，为了得到完整准确的扫描对象数据，必须将各站独立坐标系统一到同一坐标系下（如：大地坐标系或局部坐标系）.
          4. 为了最后与大地坐标转换时不影响其转换精度，需要将各扫描站的数据**先统一到某一测站的局部坐标系下**，通常选择第一站作为**母站**.通过相邻**两站间 3 个或 3 个以上的同名控制标靶**，将点云数据统一到第一测站定义的坐标系统下.
          5. 配准好的整个沉陷区的点云数据是基于相对坐标系下的，需要利用测区 GPS 控制点坐标数据进行一次坐标变换，将**相对坐标转化到大地坐标系下**.
          6. 对于每一个 GPS 控制点而言，在扫描和点云配置后获得了该点的扫描坐标系下的相对坐标，在GPS 测量中计算出该点的大地坐标，通过每个控制点的两套三维坐标，就可以通过坐标转换模型建立两套坐标系的关系，从而把点云的坐标数据转换到大地坐标系下来
          7. **（测站的点云坐标（仪器相对坐标），然后扫描站数据统一到某一测站局部坐标系。接着用gpsrtk测得控制点坐标进行坐标变换，相对转大地坐标系）**
          8. 由于三维激光扫描仪测量得到的数据与 GPS控制点之间的欧拉角可能很大，所以在纠正中不能采用小角度的空间直角坐标转换.
          9. 采用一种大旋转角的空间直角坐标转换的简便模型，该模型不仅能实现大角度的转换，而且计算过程简单，便于程序实现
          10. （它的主要思想是将旋转矩阵中的 9 个方向余弦都设为未知量，外加 3 个平移，1 个尺度，共有13 个未知数；由于旋转矩阵中仅有 3 个独立参数，根据旋转矩阵的正交特性，可列出 6 个条件式.若有n 个公共点，则可列出 3n 个观测方程，另外旋转矩阵中 9 个参数可列出 6 个条件，将这 6 个条件式作为条件方程，按附有条件的间接平差方法解算，就可获得 13 个未知数的最小二乘解.）
       3. 信息提取与制图
          1. 点云数据存在大量的噪声
             1. 利用 Cyclone 软件中 fence 框选功能直接框选出非地形、地物数据，并加以删除，减少数据冗余
                1. 对于测区地物数据的提取（如电线杆），在点云数据中直接选取最靠近地面的特征点，必要时做简单的差值处理，直接获得其特征点的三维坐标，将此坐标作为电线杆在地形图中的坐标位置，然后将数据整理成 txt 文档，导入地形图中，在 CASS软件中直接加入地物符号.对于地表点云数据，利用Cyclone 软件点云导出功能，形成 dxf 格式，导入CASS 软件中绘制地形轮廓，道路及沉陷区形成的汇水区域边界等.
                2. 地表点云数据可以作为离散的高程点来对待，利用 CASS 软件中“指定点生成数据文件”功能，按一定间距，手动提取测区内高程点数据，自动生成等高线.
                3. 对重点沉陷区可以根据需要，提取较密的高程点，生成等高距为 5 cm，10 cm 或 20 cm 等不同等高距的等高线，满足高精度工程设计要求。
                4. 三维激光扫描方式一次扫描测量点密度大，能够满足不同的测量要求，具有很大的灵活性。
          2. 得到的地物、边界、高程点及等高线进行叠加，并添加高程注记、符号注记及文字注记，生成图廓和局部修饰，生成 1:500 完整的地形图
